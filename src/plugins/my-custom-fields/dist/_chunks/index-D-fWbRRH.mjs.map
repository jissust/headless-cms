{"version":3,"file":"index-D-fWbRRH.mjs","sources":["../../admin/src/components/SelectCustomize/index.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst SelectCustomize = (props: any, ref: any) => {\n  const { attribute, disabled, intlLabel, name, onChange, required, value } = props;\n  const [productos, setProductos] = useState<any[]>([]);\n  const [selectedProducto, setSelectedProducto] = useState<any>(null);\n  const [precio, setPrecio] = useState<number>(0);\n  \n  const queryParams = new URLSearchParams(window.location.search);\n  const localId = queryParams.get('localId');\n  const tipoDeVentaId = queryParams.get('tipoDeVentaId');\n  \n  const nameSplit = name.split('.');\n  const index = parseInt(nameSplit[1]);\n  \n  let url = `/api/productos?populate=*`;\n  if(value === undefined) {\n    url += `&filters[locales][id][$eq]=${localId}`;\n  }\n  \n  useEffect(() => {\n    fetch(`${url}`)\n      .then((res) => res.json())\n      .then((data) => {\n        if (!data?.data) return;\n        setProductos(data.data);\n      })\n      .catch((err) => {\n        console.error('Error al cargar productos', err);\n      });\n  }, []);\n\n  const handleChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const selectedId = e.target.value;\n    const selectedProductoChange = productos.find((p) => p.id === parseInt(selectedId));\n\n    setSelectedProducto(selectedProductoChange);\n\n    onChange({\n      target: { name, type: attribute.type, value: selectedId },\n    });\n\n    if (selectedProductoChange) {\n      let precioSelected = (Number(tipoDeVentaId) == 1) ? selectedProductoChange.precio : selectedProductoChange.precio_mayorista;\n      setPrecio(precioSelected);\n      const stock = selectedProductoChange.stock;\n\n      onChange({\n        target: {\n          name: `Productos.${index}.cantidad`,\n          type: 'number',\n          value: stock > 0 ? 1 : 0,\n        },\n      });\n\n      onChange({\n        target: {\n          name: `Productos.${index}.total`,\n          type: 'number',\n          value: stock > 0 ? precioSelected : 0,\n        },\n      });\n    }\n  };\n\n  return (\n    <>\n      <label className='label-customize' htmlFor={name}>Producto</label>\n      <select\n        name={name}\n        disabled={disabled}\n        required={required}\n        value={value}\n        onChange={handleChange}\n        className=\"input-customize\"\n      >\n        <option value=\"\">Seleccione un producto</option>\n        {productos.map((producto: any) => (\n          <option key={producto.id} value={producto.id}>\n            {producto?.nombre || `Producto ${producto.id}`}\n          </option>\n        ))}\n      </select>\n\n      {selectedProducto && (\n        <>\n          <label className='label-customize p-1'>{(Number(tipoDeVentaId) == 1) ? \"Precio minorista\" : \"Precio mayorista\"}</label>\n          <input className='d-none' type=\"number\" name={`total-base-${index}`} value={precio} readOnly disabled/>\n        </>\n      )}\n\n    </>\n  );\n};\n\nexport { SelectCustomize };\n"],"names":[],"mappings":";;AAEA,MAAM,kBAAkB,CAAC,OAAY,QAAa;AAChD,QAAM,EAAE,WAAW,UAAU,WAAW,MAAM,UAAU,UAAU,UAAU;AAC5E,QAAM,CAAC,WAAW,YAAY,IAAI,SAAgB,CAAA,CAAE;AACpD,QAAM,CAAC,kBAAkB,mBAAmB,IAAI,SAAc,IAAI;AAClE,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAiB,CAAC;AAE9C,QAAM,cAAc,IAAI,gBAAgB,OAAO,SAAS,MAAM;AAC9D,QAAM,UAAU,YAAY,IAAI,SAAS;AACzC,QAAM,gBAAgB,YAAY,IAAI,eAAe;AAErD,QAAM,YAAY,KAAK,MAAM,GAAG;AAChC,QAAM,QAAQ,SAAS,UAAU,CAAC,CAAC;AAEnC,MAAI,MAAM;AACV,MAAG,UAAU,QAAW;AACtB,WAAO,8BAA8B,OAAO;AAAA,EAC9C;AAEA,YAAU,MAAM;AACd,UAAM,GAAG,GAAG,EAAE,EACX,KAAK,CAAC,QAAQ,IAAI,KAAA,CAAM,EACxB,KAAK,CAAC,SAAS;AACd,UAAI,CAAC,MAAM,KAAM;AACjB,mBAAa,KAAK,IAAI;AAAA,IACxB,CAAC,EACA,MAAM,CAAC,QAAQ;AACd,cAAQ,MAAM,6BAA6B,GAAG;AAAA,IAChD,CAAC;AAAA,EACL,GAAG,CAAA,CAAE;AAEL,QAAM,eAAe,CAAC,MAA4C;AAChE,UAAM,aAAa,EAAE,OAAO;AAC5B,UAAM,yBAAyB,UAAU,KAAK,CAAC,MAAM,EAAE,OAAO,SAAS,UAAU,CAAC;AAElF,wBAAoB,sBAAsB;AAE1C,aAAS;AAAA,MACP,QAAQ,EAAE,MAAM,MAAM,UAAU,MAAM,OAAO,WAAA;AAAA,IAAW,CACzD;AAED,QAAI,wBAAwB;AAC1B,UAAI,iBAAkB,OAAO,aAAa,KAAK,IAAK,uBAAuB,SAAS,uBAAuB;AAC3G,gBAAU,cAAc;AACxB,YAAM,QAAQ,uBAAuB;AAErC,eAAS;AAAA,QACP,QAAQ;AAAA,UACN,MAAM,aAAa,KAAK;AAAA,UACxB,MAAM;AAAA,UACN,OAAO,QAAQ,IAAI,IAAI;AAAA,QAAA;AAAA,MACzB,CACD;AAED,eAAS;AAAA,QACP,QAAQ;AAAA,UACN,MAAM,aAAa,KAAK;AAAA,UACxB,MAAM;AAAA,UACN,OAAO,QAAQ,IAAI,iBAAiB;AAAA,QAAA;AAAA,MACtC,CACD;AAAA,IACH;AAAA,EACF;AAEA,SACE,qBAAA,UAAA,EACE,UAAA;AAAA,IAAA,oBAAC,SAAA,EAAM,WAAU,mBAAkB,SAAS,MAAM,UAAA,YAAQ;AAAA,IAC1D;AAAA,MAAC;AAAA,MAAA;AAAA,QACC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA,UAAU;AAAA,QACV,WAAU;AAAA,QAEV,UAAA;AAAA,UAAA,oBAAC,UAAA,EAAO,OAAM,IAAG,UAAA,0BAAsB;AAAA,UACtC,UAAU,IAAI,CAAC,aACd,oBAAC,YAAyB,OAAO,SAAS,IACvC,UAAA,UAAU,UAAU,YAAY,SAAS,EAAE,GAAA,GADjC,SAAS,EAEtB,CACD;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,IAGF,oBACC,qBAAA,UAAA,EACE,UAAA;AAAA,MAAA,oBAAC,SAAA,EAAM,WAAU,uBAAwB,UAAA,OAAO,aAAa,KAAK,IAAK,qBAAqB,mBAAA,CAAmB;AAAA,MAC/G,oBAAC,SAAA,EAAM,WAAU,UAAS,MAAK,UAAS,MAAM,cAAc,KAAK,IAAI,OAAO,QAAQ,UAAQ,MAAC,UAAQ,KAAA,CAAA;AAAA,IAAA,EAAA,CACvG;AAAA,EAAA,GAGJ;AAEJ;"}